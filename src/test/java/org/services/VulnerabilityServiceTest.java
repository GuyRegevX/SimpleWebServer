package org.services;

import org.example.repositories.AssetsRepository;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

class VulnerabilityServiceTest {

    private AssetsRepository assetsRepository;
    private VulnerabilityService vulnerabilityService;

    @BeforeEach()
    public void SetUp(){
        assetsRepository = new AssetsRepository();
        vulnerabilityService = new VulnerabilityService(assetsRepository);
    }


    @Test
    public void Test(){
        try {
            vulnerabilityService.fetchCVE();
        }catch (Exception e){
            e.printStackTrace();
        }

        assetsRepository.getAllAssets().forEach(asset ->
                System.out.println(asset+" is vulnerable: "+vulnerabilityService.isAssetVulnerable(asset))
        );
    }


}